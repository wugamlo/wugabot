
<!DOCTYPE html>
<html>
<head>
    <title>Document Manager</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="document-manager">
        <h1>Document Manager</h1>
        
        <div class="upload-section">
            <h2>Upload Document</h2>
            <form id="uploadForm" enctype="multipart/form-data">
                <input type="file" id="document" name="document" accept=".txt,.pdf,.doc,.docx,.xlsx">
                <button type="submit">Upload</button>
            </form>
            <div id="uploadStatus"></div>
        </div>

        <div class="documents-list">
            <h2>Stored Documents</h2>
            <div id="documentsList"></div>
        </div>
    </div>

    <script>
        function loadDocuments() {
            fetch('/list_documents')
                .then(response => response.json())
                .then(data => {
                    const list = document.getElementById('documentsList');
                    list.innerHTML = data.documents.map(doc => `
                        <div class="document-item">
                            <span>${doc.filename}</span>
                            <span class="timestamp">${new Date(doc.timestamp).toLocaleString()}</span>
                            <button onclick="deleteDocument(${doc.id})">Delete</button>
                        </div>
                    `).join('');
                });
        }

        function deleteDocument(id) {
            if (confirm('Are you sure you want to delete this document?')) {
                fetch(`/delete_document/${id}`, { method: 'DELETE' })
                    .then(response => response.json())
                    .then(() => loadDocuments())
                    .catch(error => console.error('Error:', error));
            }
        }

        document.getElementById('uploadForm').onsubmit = function(e) {
            e.preventDefault();
            const formData = new FormData();
            const fileInput = document.getElementById('document');
            formData.append('file', fileInput.files[0]);

            fetch('/upload_document', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('uploadStatus').textContent = data.message;
                loadDocuments();
            })
            .catch(error => {
                document.getElementById('uploadStatus').textContent = 'Upload failed: ' + error;
            });
        };

        loadDocuments();
    </script>
</div>
</body>
</html>
